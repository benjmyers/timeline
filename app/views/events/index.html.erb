<div class="maincontainer">
  <div class="offset">
<% currentdate="none"%>
<div class="eventcontainer span12 row-fluid">
<!-- Go through each event (they are already ordered) and display -->
<% @events.each do |event| %>

  <%= render "events/event_partial", event: event %>

  <tr class="<%= cycle('left', 'right') -%>">
    <div class="container span6 <%= current_cycle %> row-fluid">

      <!-- If the date is different than the last iteration, create a label -->
      <% if(!currentdate.eql? event.date) %>
        <div class="date-label-<%= current_cycle %> span2">
          <%= event.date %>
        </div>
      <% else %>
        <div class="date-filler-<%= current_cycle %> span2"></div>
      <% end %>

      <!-- Save the current date to check if it's changed on the next iteration -->
      <% currentdate=event.date.clone %>

      <!-- If the event's on the right, add the time label on the left -->
     <% if(current_cycle == 'right')%>
        <div class="time-label-<%= current_cycle %> span2">
          <%= event.time %>
        </div>
      <% end %>

      <!-- Set up the popover with hidden modal. -->
      <div class="event <%= current_cycle %> span6">
        <%= link_to(image_tag(event.image.url(:medium)), "##{event.id}", {:data => {:toggle => "modal"}}) %>
      </div>

      <!-- If the event's on the left, add the time label on the right -->
      <% if(current_cycle == 'left')%>
        <div class="time-label-<%= current_cycle %> span2">
          <%= event.time %>
        </div>
      <% end %>
    </div>
  </tr>

<% end %>
</div>
</div>
</div>

